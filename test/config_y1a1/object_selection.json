{  
  "name":"object_selection",
  "op":"object_selection",
  "permanent_table": true,
  "sub_op":[  
    {  
      "name":"bitmask",
      "op":"bitmask",
      "schema_input": "y1a1_coadd_cosmos_d04",
      "permanent_table": false,
      "description":"bitmask description",
      "table_coadd_objects_molygon":"coadd_objects_molygon",
      "table_molygon":"molygon",
      "mangle_bitmask":[  
        "g",
        "r",
        "i"
      ],
      "sub_op":[  
        {  
          "name":"cuts",
          "op":"cuts",
          "schema_input": "y1a1_coadd_cosmos_d04",
          "permanent_table": false,
          "description":"cuts description",
          "table_coadd_objects":"coadd_objects",
          "mag_type":"auto",
          "sn_cuts":{  
            "g":3,
            "r":5
          },
          "bright_magnitude":{  
            "i":17.5
          },
          "magnitude_limit":{  
            "i":22
          },
          "color_cuts":{  
            "gr":[  
              -1,
              3
            ],
            "ri":[  
              -1,
              2.5
            ],
            "iz":[  
              -1,
              2
            ]
          },
          "sextractor_bands":[  
            "i",
            "z",
            "y"
          ],
          "sextractor_flags":[  
            0,
            1,
            2
          ],
          "additional_cuts":[  
            "remove_bbj",
            "'niter_model",
            "spreaderr_model",
            "bad_astronomic_colors"
          ],
          "sub_op":[  
            {  
              "name":"reduction",
              "op":"reduction",
              "schema_input":"y1a1_coadd_cosmos_d04",
              "permanent_table":false,
              "description":"object selection description",
              "table_coadd_objects_ring":"coadd_objects_pixel_4096_ring",
              "sub_op":[  
                {  
                  "name":"footprint",
                  "schema_input":"systematic_maps",
                  "db":"y1a1_coadd_cosmos_d04_4096_exptime_i_10023575",
                  "op":"footprint",
                  "permanent_table":false,
                  "description":"footprint description",
                  "sub_op":[  
                    {  
                      "name":"exposure_time",
                      "op":"join",
                      "permanent_table":false,
                      "description":"systematic_maps exposure_time",
                      "sub_op":[  
                        {  
                          "name":"exposure_time_i",
                          "schema_input":"systematic_maps",
                          "db":"y1a1_coadd_cosmos_d04_4096_exptime_i_10023575",
                          "op":"great_equal",
                          "permanent_table":false,
                          "description":"exposure_time_i description",
                          "band":"g",
                          "value":"600"
                        },
                        {  
                          "name":"exposure_time_r",
                          "schema_input":"systematic_maps",
                          "db":"y1a1_coadd_cosmos_d04_4096_exptime_r_10023575",
                          "op":"great_equal",
                          "permanent_table":false,
                          "description":"exposure_time_r description",
                          "band":"r",
                          "value":"600"
                        },
                        {  
                          "name":"exposure_time_z",
                          "schema_input":"systematic_maps",
                          "db":"y1a1_coadd_cosmos_d04_4096_exptime_z_10023575",
                          "op":"great_equal",
                          "permanent_table":false,
                          "description":"exposure_time_z description",
                          "band":"z",
                          "value":"300"
                        }
                      ]
                    },
                    {  
                      "name":"mangle_map",
                      "op":"join",
                      "permanent_table":false,
                      "description":"mangle_maps description",
                      "sub_op":[  
                        {  
                          "name":"mangle_maps_i",
                          "schema_input":"y1a1_coadd_cosmos_d04",
                          "db":"mangle_maps_4096_ring_frac_i_10024132",
                          "op":"great_equal",
                          "permanent_table":false,
                          "description":"depth_map description",
                          "band":"g",
                          "value":"0.5"
                        },
                        {  
                          "name":"mangle_maps_r",
                          "schema_input":"y1a1_coadd_cosmos_d04",
                          "db":"mangle_maps_4096_ring_frac_r_10024132",
                          "op":"great_equal",
                          "permanent_table":false,
                          "description":"exposure_time_r description",
                          "band":"r",
                          "value":"0.5"
                        }
                      ]
                    },
                    {  
                      "name":"bad_regions",
                      "schema_input":"bright_mask",
                      "db":"y1a1_coadd_cosmos_d04_bright_mask_4096_ring_10023572",
                      "op":"bad_regions",
                      "permanent_table":false,
                      "value":"1"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
